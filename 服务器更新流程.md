# 掌上盛京服务器更新流程 #

## 当前服务器工程commit标识 ##
- server：`0bad1de58d8be68fbb273d135eeea5fa669eec50`
- server-release：`0dd6b5dd08771a1e6936358fe849d7654e82c2c6`

## 更新流程 ##
- 登录172.28.235.113服务器
- 停止113上Tomcat的两个docker容器
```
docker stop isjofficial_isj-pep1_official_1
docker stop isjofficial_isj-pep2_official_1
```
- 删除tomcat下的工程和war包
```
rm -rf /opt/docker/isj_official/pep1/tomcat/webapps/isj.war
rm -rf /opt/docker/isj_official/pep1/tomcat/webapps/isj/
rm -rf /opt/docker/isj_official/pep2/tomcat/webapps/isj.war
rm -rf /opt/docker/isj_official/pep2/tomcat/webapps/isj/
```
- 将要更新的war包复制到原路径下
- 启动docker容器
```
docker start isjofficial_isj-pep1_official_1
docker start isjofficial_isj-pep2_official_1
```
- 等待两个docker容器启动成功
- 登录172.28.235.115服务器，更新步骤和113一致
- 登录172.28.235.114服务器
- 停止114上Tomcat的docker容器
```
docker stop isjofficial_isj-pep1_official_1
```
- 删除tomcat下的工程和war包
```
rm -rf /opt/docker/isj_official/pep1/tomcat/webapps/isj.war
rm -rf /opt/docker/isj_official/pep1/tomcat/webapps/isj/
```
- 将要更新的war包复制到原路径下，war包需要修改WEB-INF/classes/conf/isj目录下的isj.properties文件
```
#isj.properties
isj.info.scheduling.init=1
```
- 启动docker容器
```
docker start isjofficial_isj-pep1_official_1
```
- 等待docker容器启动成功
- 修改本文档的commit标识
