<?xml version="1.0" encoding="UTF-8"?>
<configuration scan="true" scanPeriod="5 seconds">

    <appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>logs/logFile.%d{yyy-MM-dd}.log</fileNamePattern>
            <maxHistory>7</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%5p [%d{yy-MM-dd-HH:mm:ss}] %40.40c:%4L - %m%n</pattern>
        </encoder>
    </appender>
    
    <appender name="payLogApp" class="com.proper.enterprise.isj.payment.logger.logback.appender.PayLogAppender">
    </appender>
    
    <!-- 为了减少对实时业务的影响，日志记录采用异步方式调用。因为延时退款业务的延时时间很长，有足够的时间来记录业务。 -->
    <appender name="asyncPayLogApp" class="com.proper.enterprise.isj.payment.logger.logback.appender.PayLogAsyncAppender">  
            <!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 -->  
            <discardingThreshold>0</discardingThreshold>  
            <!-- 更改默认的队列的深度,该值会影响性能.默认值为256 -->  
            <queueSize>5120</queueSize>
            <!-- 添加附加的appender,最多只能添加一个 -->  
         <appender-ref ref ="payLogApp"/>  
     </appender>  
    
    <logger name="delayRefundLogger" level="trace">
    	<appender-ref ref="asyncPayLogApp" />
    </logger>

    <appender name="mongo" class="com.proper.enterprise.platform.core.mongo.logback.MongoDBAppender">
        <connectionSource class="com.proper.enterprise.platform.core.mongo.logback.MongoDBConnectionSource">
            <host>172.28.235.115</host>
            <port>27017</port>
            <database>isj</database>
            <username>isj</username>
            <password>isj</password>
            <collection>LOGS</collection>
        </connectionSource>
    </appender>

    <logger name="com.proper" level="debug">
        <appender-ref ref="mongo" />
    </logger>

    <logger name="ROOT" level="info">
        <appender-ref ref="file" />
    </logger>

</configuration>
